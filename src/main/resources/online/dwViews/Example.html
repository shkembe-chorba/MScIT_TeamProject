<html>

<head>
    <!-- Web page title -->
    <title>Top Trumps</title>

    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css"
        integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
        integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous">
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js"
        integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous">
    </script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"
        integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous">
    </script>

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">

</head>

<body onload="initalize()">
    <div class="container">

        <!-- New Game Modal -->
        <!-- #newGameModal -->
        <div class="modal fade" id="newGameModal" tabindex="-1" role="dialog" aria-labelledby="newGameModal"
            aria-hidden="true">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">New Top Trumps Game</h5>
                        <!-- .newGameModal-abort -->
                        <button type="button" class="close newGameModal-abort" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <div class="modal-body">

                        <label><input type="radio" name="newGameModal-aiPlayers" value="male">Male</label>
                        <label><input type="radio" name="newGameModal-aiPlayers" value="female">Female</label>

                    </div>
                    <div class="modal-footer">
                        <!-- .newGameModal-abort -->
                        <button type="button" class="btn btn-secondary newGameModal-abort"
                            data-dismiss="modal">Close</button>
                        <!-- #newGameModal-play -->
                        <button id="newGameModal-play" type="button" class="btn btn-primary"
                            data-dismiss="modal">Play</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Game Logic -->
        <div class="row">
            <div class="card-deck">
                <!-- Communal Pile -->
                <div class="card">
                    <div class="card-header">
                        <div class="row ">
                            <div class="col-12 d-flex justify-content-center">
                                <h3>
                                    <span class="badge badge-secondary">
                                        <i class="fa fa-exchange" aria-hidden="true"></i>
                                        Communal Pile
                                    </span>
                                </h3>
                            </div>
                            <div class="col-12 d-flex justify-content-center">
                                <span class="badge badge-light">
                                    Cards in deck: <span class="badge badge-primary badge-pill">14</span>
                                </span>
                            </div>
                        </div>
                    </div>


                    <div class="card-body">

                        <div class="card-hider">
                            <div class="row align-items-center" style="height: 100%">
                                <div class="col text-center">
                                    <h3>Top Trumps</h3>
                                </div>
                            </div>
                        </div>

                        <h4 class="card-title">Card Title</h4>

                        <ul class="list-group list-group-flush">
                            <li class="list-group-item d-flex justify-content-between align-items-center">
                                Attribute
                                <span class="badge badge-primary badge-pill">14</span>
                            </li>
                        </ul>
                    </div>
                </div>

            </div>


        </div>




    </div>

    <style>
        /* Styling for a 'card cover' that masks the card's attributes */
        .card-hider {
            position: absolute;
            height: 100%;
            width: 100%;
            background-color: rebeccapurple;
            z-index: 100;
            left: 0;
            top: 0;
            visibility: visible;
        }

        .card-hider-show {
            visibility: hidden;
        }

        /* This is needed to ensure the card hider doesn't cover the card header (which has player info) */
        .card-body {
            position: relative;
        }
    </style>

    <script type="text/javascript">
        const attributeFactory = attribute => {
            return `
              <li class="list-group-item d-flex justify-content-between align-items-center">
                ${attributeName}
                <span class="badge badge-primary badge-pill">${attributeValue}</span>
              </li>
            `
        }

        const playerFactory = player => {

            return `
            <div class="card">
              <div class="card-header">
                <div class="row ">
                    <div class="col-12 d-flex justify-content-center">
                        <h3>
                            <span class="badge badge-success">
                                <i class="fa fa-user" aria-hidden="true"></i>
                                ${player.name}
                                <i class="fa fa-star" aria-hidden="true"></i>
                            </span>
                        </h3>
                    </div>
                    <div class="col-12 d-flex justify-content-center">
                        <span class="badge badge-light">
                            Cards in deck: <span class="badge badge-primary badge-pill">${player.deckSize}</span>
                        </span>
                    </div>
                </div>
            </div>

            <div class="card-body">

                <div class="card-hider">
                    <div class="row align-items-center" style="height: 100%">
                        <div class="col text-center">
                            <h3>Top Trumps</h3>
                        </div>
                    </div>
                </div>

                <h4 class="card-title">Card Title</h4>

                <ul class="list-group list-group-flush">
                    ${attributes.forEach(a => attributeFactory(a))}
                </ul>
            </div>
          </div>
            `;
        };

        const insertPlayers = playerArray => {
            playerArray.forEach(player => {
                playerFactory(player);
            });
        };
    </script>


    <script type="text/javascript">
        /*
            All the selectors for this page.
        */

        // ids (#)
        // ---------------------------
        const NEW_GAME_MODAL = '#newGameModal';
        const NEW_GAME_MODAL_PLAY = '#newGameModal-play';
        const NEW_GAME_MODAL_PLAYERS = '#newGameModal-players';

        // classes (.) - Can be multiple elements
        // ----------------------------------------------------------
        const NEW_GAME_MODAL_CLOSERS = '.newGameModal-abort';

        // input names
        const NEW_GAME_MODAL_SELECTION = 'input[name=newGameModal-aiPlayers]:checked';

        // End
    </script>

    <script type="text/javascript">
        // ON WINDOW INITIALISE
        function initalize() {
            // $(NEW_GAME_MODAL).modal('show');

            // Attach redirectors if the user aborts
            $(NEW_GAME_MODAL_CLOSERS).click(() => {
                window.location.href = "./SelectionScreen.html";
            })

            // Start new game
            $(NEW_GAME_MODAL_PLAY).click(() => {
                const numAiPlayers = $(NEW_GAME_MODAL_SELECTION).val();
                setupGame(numAiPlayers);
            });
        }

        function setupGame(numAiPlayers) {
            $('#player').player();
        }

        function setupRound() {

        }


        // This is a reusable method for creating a CORS request. Do not edit this.
        function createCORSRequest(method, url) {
            var xhr = new XMLHttpRequest();
            if ("withCredentials" in xhr) {

                // Check if the XMLHttpRequest object has a "withCredentials" property.
                // "withCredentials" only exists on XMLHTTPRequest2 objects.
                xhr.open(method, url, true);

            } else if (typeof XDomainRequest != "undefined") {

                // Otherwise, check if XDomainRequest.
                // XDomainRequest only exists in IE, and is IE's way of making CORS requests.
                xhr = new XDomainRequest();
                xhr.open(method, url);

            } else {
                // Otherwise, CORS is not supported by the browser.
                xhr = null;
            }
            return xhr;
        }
    </script>








    <!-- Here are examples of how to call REST API Methods -->
    <script type="text/javascript">
        // This calls the helloJSONList REST method from TopTrumpsRESTAPI
        function helloJSONList() {

            var xhr = createCORSRequest('GET', "http://localhost:7777/toptrumps/helloJSONList");

            // Message is not sent yet, but we can check that the browser supports CORS
            if (!xhr) {
                alert("CORS not supported");
            }

            // CORS requests are Asynchronous, i.e. we do not wait for a response, instead we define an action
            // to do when the response arrives
            xhr.onload = function (e) {
                var responseText = xhr.response; // the text of the response
                // alert(responseText); // lets produce an alert
            };

            // We have done everything we need to prepare the CORS request, so send it
            xhr.send();
        }

        // This calls the helloJSONList REST method from TopTrumpsRESTAPI
        function helloWord(word) {

            // First create a CORS request, this is the message we are going to send (a get request in this case)
            var xhr = createCORSRequest('GET', "http://localhost:7777/toptrumps/helloWord?Word=" +
                word); // Request type and URL+parameters

            // Message is not sent yet, but we can check that the browser supports CORS
            if (!xhr) {
                alert("CORS not supported");
            }

            // CORS requests are Asynchronous, i.e. we do not wait for a response, instead we define an action
            // to do when the response arrives
            xhr.onload = function (e) {
                var responseText = xhr.response; // the text of the response
                // alert(responseText); // lets produce an alert
            };

            // We have done everything we need to prepare the CORS request, so send it
            xhr.send();
        }
    </script>
</body>

</html>